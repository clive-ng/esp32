#include <WiFi.h>
#include <WebServer.h>

// Set your own network name and password
const char* ssid = "Museum_Wayfinding_Node_1";
const char* password = "password123";

WebServer server(80); // Create a TCP Server on port 80

// The HTML code for the Web App
String htmlPage = R"rawliteral(
<!DOCTYPE html>
<html>
<head><meta name="viewport" content="width=device-width, initial-scale=1"></head>
<body>
  <h1>Exhibit Navigator</h1>
  <p>You are at the East Wing junction.</p>
  <button onclick="fetch('/light?dir=left')">Show path to Dinosaurs</button>
  <button onclick="fetch('/light?dir=right')">Show path to Space</button>
</body>
</html>
)rawliteral";

void setup() {
  Serial.begin(115200);
  pinMode(2, OUTPUT); // Onboard LED
  
  // Set ESP32 to AP (Access Point) Mode
  WiFi.softAP(ssid, password);
  
  server.on("/", []() {
    server.send(200, "text/html", htmlPage);
  });

  server.on("/light", []() {
    String direction = server.arg("dir");
    if(direction == "left") {
      digitalWrite(2, HIGH); // Turn LED ON
    } else {
      digitalWrite(2, LOW);  // Turn LED OFF
    }
    server.send(200, "text/plain", "Direction set to " + direction);
  });

  server.begin(); // Start the TCP Server
  Serial.println("Server started.");
}

void loop() {
  server.handleClient(); // Listen for incoming web app requests
}
